<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
  <link rel="stylesheet" href="css/style.css">
  <meta name="description" content="">

  <meta property="og:title" content="">
  <meta property="og:type" content="">
  <meta property="og:url" content="">
  <meta property="og:image" content="">
  <meta property="og:image:alt" content="">

  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/icon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="icon.png">

  <link rel="manifest" href="site.webmanifest">
  <meta name="theme-color" content="#fafafa">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<!--  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>-->

  <style>
    /* General Styles */
    body {
      font-family: Arial, sans-serif;
      background-color: #f8f9fa;
    }

    /* Container */
    .container {
      background: #ffffff;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
    }

    /* Heading */
    h1, h2 {
      text-align: center;
      color: #343a40;
    }

    /* Buttons */
    .btn {
      font-weight: bold;
      border-radius: 5px;
    }

    .btn-primary {
      background-color: #007bff;
      border: none;
    }

    .btn-primary:hover {
      background-color: #0056b3;
    }

    /* Add Button */
    #addBtn {
      background-color: #28a745;
      color: white;
      float: right;
    }

    #addBtn:hover {
      background-color: #218838;
    }

    /* Form Styling */
    .box-container {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .box-label {
      width: 80px;
      font-weight: bold;
    }

    .form-control {
      border-radius: 5px;
    }

    /* File Input */
    .circular-file-input {
      padding: 5px;
    }

    /* Table Styling */
    .table {
      background-color: white;
      border-radius: 5px;
      overflow: hidden;
    }

    .table thead {
      background-color: #343a40;
      color: white;
    }

    .table tbody tr:hover {
      background-color: #f1f1f1;
    }

    .table td, .table th {
      text-align: center;
      padding: 10px;
    }

    /* Update & Delete Buttons */
    .btn-light {
      background-color: #ffc107;
      color: #212529;
      border: none;
    }

    .btn-light:hover {
      background-color: #e0a800;
    }

    .btn-danger {
      background-color: #dc3545;
      color: white;
    }

    .btn-danger:hover {
      background-color: #c82333;
    }

    /* Modal Styling */
    .modal-content {
      padding: 20px;
      border-radius: 10px;
    }

    .modal h2 {
      margin-bottom: 20px;
    }

  </style>
</head>

<body>

<div class="container mt-5">
  <h1 class="text-center">Customer Manage</h1>
  <hr/>

  <button id="addBtn" type="button" class="btn  mb-3 text-right" data-bs-toggle="modal"
          data-bs-target="#customerModal">
    Add Customer
  </button>

  <!--     add student modal-->
  <div class="modal fade" id="customerModal" tabindex="-1" aria-labelledby="customerModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="container m-2">
          <form>
            <h2>ADD CUSTOMER</h2>
            <div class="mb-4 box-container">
              <div class="box-label">
                <label for="id" class="form-label">ID</label>
              </div>
              <input type="text" class="form-control" id="id">
            </div>
            <div class="mb-4 box-container">
              <div class="box-label">
                <label for="name" class="form-label">  NAME</label>
              </div>
              <input type="text" class="form-control" id="name">
            </div>
            <div class="mb-4 box-container">
              <div class="box-label">
                <label for="address" class="form-label"> ADDRESS</label>
              </div>
              <input type="text" class="form-control" id="address">
            </div>

            <button id="btn_save_customer" type="submit" class="btn btn-primary" >Save</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Update student Modal -->
  <div class="modal fade" id="updateCustomerModal" tabindex="-1" aria-labelledby="updateCustomerModalLabel"
       aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="container m-2">
          <form>
            <h2>UPDATE CUSTOMER</h2>
            <div class="mb-3 box-container">
              <div class="box-label">
                <label for="id" class="form-label">ID</label>
              </div>
              <input type="text" class="form-control" id="updated_customer_id" readonly>
            </div>
            <div class="mb-3 box-container">
              <div class="box-label">
                <label for="name" class="form-label">  NAME</label>
              </div>
              <input type="text" class="form-control" id="updated_name">
            </div>
            <div class="mb-3 box-container">
              <div class="box-label">
                <label for="address" class="form-label"> ADDRESS</label>
              </div>
              <input type="text" class="form-control" id="updated_address">
            </div>


            <button id="btn_update_customer" type="submit" class="btn btn-primary">Update</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <table class="table table-bordered">
    <thead >
    <tr>
      <!--      <td>Profile</td>-->
      <td>ID</td>
      <td>Name</td>
      <td>Address</td>
      <td>Update</td>
      <td>Delete</td>

    </tr>
    </thead>
    <tbody id="customer_table_body">

    </tbody>
  </table>
</div>
<script src="js/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const getAllCustomer=()=>{
    $.ajax({
      url: 'http://localhost:8080/api/v1/customer/getAll',
      type: "GET",
      success:(res) =>{
        console.log(res)
        $('#customer_table_body').empty()
        res.data.forEach(customer => {
          $('#customer_table_body').append(`
                 <tr>
                    <td>${customer.id}</td>
                    <td>${customer.name}</td>
                    <td>${customer.address}</td>


                     <td>
                          <button class="btn btn-light btn-sm" onclick="editCustomer('${customer.id}','${customer.name}','${customer.address}')">
                           Update
                           </button>
                      </td>
                       <td>
                            <button class="btn btn-light btn-sm" onclick="deleteCustomer('${customer.id}')">
                              Delete
                             </button>
                        </td>
                     </tr>

          `)
        })

      },
      errors:(err) =>{
        console.log(err)
      }

    })
  }
  $(document).ready(function (){
    getAllCustomer();
  })
</script>
<script>
  $('#btn_save_customer').click((e) =>{
    e.preventDefault();
    const customerId=$("#id").val();
    const customerName=$('#name').val();
    const  customerAddress=$('#address').val();


    const customerData ={
      id:customerId,
      name: customerName,
      address: customerAddress,

    };

    $.ajax({
      url:'http://localhost:8080/api/v1/customer/save',
      type:"POST",
      data:JSON.stringify(
        customerData
      ),
      contentType:"application/json",
      success:(res) =>{
        getAllCustomer()
        console.log(res)
      },
      errors:(err) =>{
        console.log(err)
      }

    })
  })
</script>
<script>
  const deleteCustomer=(id) =>{
    $.ajax({
      url:`http://localhost:8080/api/v1/customer/delete/${id}`,
      type:'DELETE',
      success:(res)=>{
        console.log(res)
        getAllCustomer()

      },
      error:(err) =>{
        console.log(err)
      }

    })
  }
</script>
<script>
  const editCustomer=(id,name,address,age) =>{
    $('#updated_customer_id').val(id)
    $('#updated_name').val(name)
    $('#updated_address').val(address)
    $('#updateCustomerModal').modal('show')
  }
</script>
<script>
  $('#btn_update_customer').click((e) =>{
    e.preventDefault()
    const id=$('#updated_customer_id').val()
    const name=$('#updated_name').val()
    const address=$('#updated_address').val()


    const updateCustomerData={
      id,
      name,
      address


    }
    $.ajax({
      url:'http://localhost:8080/api/v1/customer/update',
      type:'PUT',
      data: JSON.stringify(updateCustomerData),
      contentType:"application/json",
      success:(res)=>{
        getAllCustomer()
        console.log(res)
      },
      error:(res)=>{
        console.log(err)
      }


    })
  })
</script>
</body>

</html>
